#include <PR/ultratypes.h>

#include "sm64.h"
#include "actors/common1.h"
#include "gfx_dimensions.h"
#include "game_init.h"
#include "level_update.h"
#include "camera.h"
#include "print.h"
#include "ingame_menu.h"
#include "hud.h"
#include "segment2.h"
#include "area.h"
#include "save_file.h"
#include "print.h"
#include "engine/surface_load.h"
#include "game/object_helpers.h"
//#include "src/s2d_engine/init.h"
#include "!COMIT_LIBRARY.h"
//#include "s2d_engine/s2d_draw.h"
//#include "s2d_engine/s2d_print.h"
#include "object_list_processor.h"
#include "puppyprint.h"
#include "include/config.h"
#include "engine/math_util.h"
// #include "text_strings.h.in"
#include "behavior_data.h"

/* @file hud.c
 * This file implements HUD rendering and power meter animations.
 * That includes stars, lives, coins, camera status, power meter, timer
 * cannon reticle, and the unused keys.
 **/



// ------------- FPS COUNTER ---------------
// To use it, call print_fps(x,y); every frame.
#define FRAMETIME_COUNT 30

OSTime frameTimes[FRAMETIME_COUNT];
u8 curFrameTimeIndex = 0;

#include "PR/os_convert.h"

// Call once per frame
f32 calculate_and_update_fps() {
    OSTime newTime = osGetTime();
    OSTime oldTime = frameTimes[curFrameTimeIndex];
    frameTimes[curFrameTimeIndex] = newTime;

    curFrameTimeIndex++;
    if (curFrameTimeIndex >= FRAMETIME_COUNT) {
        curFrameTimeIndex = 0;
    }
    return ((f32)FRAMETIME_COUNT * 1000000.0f) / (s32)OS_CYCLES_TO_USEC(newTime - oldTime);
}

void print_fps(s32 x, s32 y) {
    f32 fps = calculate_and_update_fps();
    char text[14];

    sprintf(text, "FPS %2.2f", fps);
    #ifdef PUPPYPRINT
    print_small_text(x, y, text, PRINT_TEXT_ALIGN_LEFT, PRINT_ALL, FONT_OUTLINE);
    #else
    print_text(x, y, text, 0);
    #endif

}

// ------------ END OF FPS COUNER -----------------



struct UnusedHUDStruct {
    u32 unused1;
    u16 unused2;
    u16 unused3;
};

struct CameraHUD {
    s16 status;
};

// Stores health segmented value defined by numHealthWedges
// When the HUD is rendered this value is 8, full health.
static s16 sPowerMeterStoredHealth;

struct PowerMeterHUD sPowerMeterHUD = {
    POWER_METER_HIDDEN,
    40,
    166,
    1.0,
};

// Power Meter timer that keeps counting when it's visible.
// Gets reset when the health is filled and stops counting
// when the power meter is hidden.
s32 sPowerMeterVisibleTimer = 0;

s32 gHudTopY = 219; // default 219, high is 235
s32 gHudStarsX = 22;
u8 gHudYMax = 235; // 235 - 8 on console
u8 gHudYMin = 219; // 219 - 8 on console
// s32 gHuds2dX = 0;
//UNUSED static struct UnusedHUDStruct sUnusedHUDValues = { 0x00, 0x0A, 0x00 };

static struct CameraHUD sCameraHUD = { CAM_STATUS_NONE };


extern u8 textAButton[];



Gfx target_ia8_target_ia8_aligner[] = {gsSPEndDisplayList()};
u8 target_ia8_target_ia8[] = {
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf2, 0xf4, 0xf7, 
	0xf8, 0xfa, 0xfb, 0xfd, 0xfe, 0xfe, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf2, 0xf5, 0xf8, 0xfb, 0xfe, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf4, 0xf8, 0xfc, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf5, 0xf9, 0xfe, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf3, 
	0xf8, 0xfd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf4, 0xfa, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf5, 0xfb, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf5, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf3, 
	0xfa, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf1, 0xf8, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf5, 0xfc, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf1, 0xf8, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf4, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf6, 0xfd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf1, 0xf8, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfd, 0xfb, 
	0xf8, 0xf6, 0xf5, 0xf3, 0xf2, 0xf1, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf2, 0xf9, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xfc, 0xf9, 0xf5, 0xf2, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf3, 0xfa, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 
	0xf7, 0xf3, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf4, 0xfb, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xfd, 0xf8, 0xf3, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf4, 0xfb, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xfc, 0xf6, 0xf1, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf4, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xfc, 0xf6, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf3, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfd, 0xf7, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf2, 
	0xfa, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xf9, 0xf2, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf1, 0xf9, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xfc, 0xf5, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf8, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf9, 0xf2, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf6, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xfe, 0xf6, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf4, 0xfd, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 
	0xf5, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf1, 0xfb, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfb, 0xf3, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf8, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xfa, 0xf2, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf5, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xfa, 0xf2, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf1, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xfa, 0xf2, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xfb, 0xf2, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf3, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xfc, 0xf3, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xfa, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xfe, 0xf5, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf5, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf6, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xfb, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf9, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf5, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 0xf2, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xfb, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf5, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf4, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xf9, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xfa, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xfd, 0xf2, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf3, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xf7, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf8, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xfc, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xfd, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xf6, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf5, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xfc, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xf9, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf6, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf0, 0xfe, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xfd, 0xf1, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf4, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xf8, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xf3, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf0, 0xfc, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xfc, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf2, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf7, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf5, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf3, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfc, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf9, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf0, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf5, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf2, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf2, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf4, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfd, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf7, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfb, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xf8, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf8, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xfa, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf6, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xfb, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf5, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xfd, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf3, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf2, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf1, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
	0xff, 0xff, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 
	
};

Vtx target_target_mesh_vtx_cull[8] = {
	{{{-8, -8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{-8, -8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{-8, 8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{-8, 8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{8, -8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{8, -8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{8, 8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
	{{{8, 8, 0},0, {-16, -16},{0x0, 0x0, 0x0, 0x0}}},
};

Vtx target_target_mesh_vtx_0[4] = {
	{{{-8, -8, 0},0, {-16, 4080},{0x0, 0x0, 0x7F, 0xFF}}},
	{{{8, -8, 0},0, {4080, 4080},{0x0, 0x0, 0x7F, 0xFF}}},
	{{{8, 8, 0},0, {4080, -16},{0x0, 0x0, 0x7F, 0xFF}}},
	{{{-8, 8, 0},0, {-16, -16},{0x0, 0x0, 0x7F, 0xFF}}},
};

Gfx target_target_mesh_tri_0[] = {
	gsSPVertex(target_target_mesh_vtx_0 + 0, 4, 0),
	gsSP2Triangles(0, 1, 2, 0, 0, 2, 3, 0),
	gsSPEndDisplayList(),
};

Gfx mat_target_Target_layer1[] = {
	gsDPPipeSync(),
	gsDPSetCombineLERP(TEXEL0, 0, ENVIRONMENT, 0, TEXEL0, 0, ENVIRONMENT, 0, TEXEL0, 0, ENVIRONMENT, 0, TEXEL0, 0, ENVIRONMENT, 0),
	// gsDPSetRenderMode(G_RM_AA_ZB_XLU_SURF, G_RM_AA_ZB_XLU_SURF2),
	gsDPSetRenderMode(G_RM_XLU_SURF, G_RM_XLU_SURF2),
	gsSPTexture(65535, 65535, 0, 0, 1),
	gsDPTileSync(),
	gsDPSetTextureImage(G_IM_FMT_IA, G_IM_SIZ_8b_LOAD_BLOCK, 1, target_ia8_target_ia8),
	gsDPSetTile(G_IM_FMT_IA, G_IM_SIZ_8b_LOAD_BLOCK, 0, 0, 7, 0, G_TX_WRAP | G_TX_MIRROR, 6, 0, G_TX_WRAP | G_TX_MIRROR, 6, 0),
	gsDPLoadSync(),
	gsDPLoadBlock(7, 0, 0, 2047, 256),
	gsDPPipeSync(),
	gsDPSetTile(G_IM_FMT_IA, G_IM_SIZ_8b, 8, 0, 0, 0, G_TX_WRAP | G_TX_MIRROR, 6, 0, G_TX_WRAP | G_TX_MIRROR, 6, 0),
	gsDPSetTileSize(0, 0, 0, 252, 252),
	gsSPEndDisplayList(),
};

Gfx mat_revert_target_Target_layer1[] = {
	gsDPPipeSync(),
	gsDPSetRenderMode(G_RM_AA_ZB_OPA_SURF, G_RM_AA_ZB_OPA_SURF2),
	gsSPEndDisplayList(),
};

Gfx target_target_mesh[] = {
	gsSPClearGeometryMode(G_LIGHTING),
	gsSPVertex(target_target_mesh_vtx_cull + 0, 8, 0),
	gsSPSetGeometryMode(G_LIGHTING),
	gsSPCullDisplayList(0, 7),
	gsSPDisplayList(mat_target_Target_layer1),
	gsSPDisplayList(target_target_mesh_tri_0),
	gsSPDisplayList(mat_revert_target_Target_layer1),
	gsDPPipeSync(),
	gsSPSetGeometryMode(G_LIGHTING),
	gsSPClearGeometryMode(G_TEXTURE_GEN),
	gsDPSetCombineLERP(0, 0, 0, SHADE, 0, 0, 0, ENVIRONMENT, 0, 0, 0, SHADE, 0, 0, 0, ENVIRONMENT),
	gsSPTexture(65535, 65535, 0, 0, 0),
	gsSPEndDisplayList(),
};


#include "map_data/manager_model.inc.c"

#include "game/logo/model.inc.c"
#include "game/logo/header.h"
// #include "game/logo_console/model.inc.c"
// #include "game/logo_console/header.h"

s16 sLogoOpacity = 0;
s16 sLogoTimer = 0;

void render_logo(void) {
	create_dl_ortho_matrix();
    create_dl_translation_matrix(MENU_MTX_PUSH, 160.0f, 150.0f, 0.0f);
    // if (gIsConsole) {
    //     create_dl_scale_matrix(MENU_MTX_NOPUSH, 1.25f, 1.25f, 1.0f);
    // }
	if (sLogoTimer > 70) {
		sLogoOpacity += 4;
		if (sLogoOpacity > 255) {
			sLogoOpacity = 255;
		}
	} else {
		sLogoTimer++;
	}
    gDPSetEnvColor(gDisplayListHead++, 0xFF, 0xFF, 0xFF, sLogoOpacity);
    gSPDisplayList(gDisplayListHead++, &logo_Plane_mesh);
    // gSPDisplayList(gDisplayListHead++, &logo_console_PlaneConsole_mesh);
    gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
}




extern struct Object *gTomatoObjs[3];

void render_targets(void) {
    struct Object *obj1 = gTomatoObjs[0];
    struct Object *obj2 = gTomatoObjs[1];
    struct Object *obj3 = gTomatoObjs[2];
    if (obj1) {
        render_target(obj1);
        if (obj1->os16F8 > 0) {
            obj1->os16FE = approach_s16_symmetric(obj1->os16FE, 255, 0x12);
            obj1->os16F8--;
        } else {
            obj1->os16FE = approach_s16_symmetric(obj1->os16FE, 0, 0x16);
        }
    }

    if (obj2) {
        render_target(obj2);
        if (obj2->os16F8 > 0) {
            obj2->os16FE = approach_s16_symmetric(obj2->os16FE, 255, 0x12);
            obj2->os16F8--;
        } else {
            obj2->os16FE = approach_s16_symmetric(obj2->os16FE, 0, 0x16);
        }
    }

    if (obj3) {
        render_target(obj3);
        if (obj3->os16F8 > 0) {
            obj3->os16FE = approach_s16_symmetric(obj3->os16FE, 255, 0x12);
            obj3->os16F8--;
        } else {
            obj3->os16FE = approach_s16_symmetric(obj3->os16FE, 0, 0x16);
        }
    }

}

void create_dl_scale_matrix(s8 pushOp, f32 x, f32 y, f32 z);
void create_dl_rotation_matrix(s8 pushOp, f32 a, f32 x, f32 y, f32 z);

void render_target(struct Object *obj) {
    create_dl_translation_matrix(MENU_MTX_PUSH, (f32)obj->os16F4, (f32)obj->os16F6, 0.0f);
    if (gIsConsole) {
        create_dl_scale_matrix(MENU_MTX_NOPUSH, 1.25f, 1.25f, 1.0f);
    }
    gDPSetEnvColor(gDisplayListHead++, 0xE7, 0x00, 0x00, obj->os16FE);
    gSPDisplayList(gDisplayListHead++, &target_target_mesh);
    gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
}






/**
 * Renders a rgba16 16x16 glyph texture from a table list.
 */
void render_hud_tex_lut(s32 x, s32 y, u8 *texture) {
    Gfx* dlhead = gDisplayListHead;
    gDPPipeSync(dlhead++);
    gDPSetTextureImage(dlhead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, texture);
    gSPDisplayList(dlhead++, &dl_hud_img_load_tex_block);
    gSPTextureRectangle(dlhead++, x << 2, y << 2, (x + 15) << 2, (y + 15) << 2,
                        G_TX_RENDERTILE, 0, 0, 4 << 10, 1 << 10);
    gDisplayListHead = dlhead;
}

/**
 * Renders a rgba16 8x8 glyph texture from a table list.
 */
void render_hud_small_tex_lut(s32 x, s32 y, u8 *texture) {
    Gfx* dlhead = gDisplayListHead;
    gDPSetTile(dlhead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 0, 0, G_TX_LOADTILE, 0,
                G_TX_WRAP | G_TX_NOMIRROR, G_TX_NOMASK, G_TX_NOLOD, G_TX_WRAP | G_TX_NOMIRROR, G_TX_NOMASK, G_TX_NOLOD);
    gDPTileSync(dlhead++);
    gDPSetTile(dlhead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 2, 0, G_TX_RENDERTILE, 0,
                G_TX_CLAMP, 3, G_TX_NOLOD, G_TX_CLAMP, 3, G_TX_NOLOD);
    gDPSetTileSize(dlhead++, G_TX_RENDERTILE, 0, 0, (8 - 1) << G_TEXTURE_IMAGE_FRAC, (8 - 1) << G_TEXTURE_IMAGE_FRAC);
    gDPPipeSync(dlhead++);
    gDPSetTextureImage(dlhead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, texture);
    gDPLoadSync(dlhead++);
    gDPLoadBlock(dlhead++, G_TX_LOADTILE, 0, 0, 8 * 8 - 1, CALC_DXT(8, G_IM_SIZ_16b_BYTES));
    gSPTextureRectangle(dlhead++, x << 2, y << 2, (x + 7) << 2, (y + 7) << 2, G_TX_RENDERTILE,
                        0, 0, 4 << 10, 1 << 10);
    gDisplayListHead = dlhead;
}

/**
 * Renders power meter health segment texture using a table list.
 */
void render_power_meter_health_segment(s16 numHealthWedges) {
    u8 *(*healthLUT)[] = segmented_to_virtual(&power_meter_health_segments_lut);
    Gfx* dlhead = gDisplayListHead;

    gDPPipeSync(dlhead++);
    gDPSetTextureImage(dlhead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1,
                       (*healthLUT)[numHealthWedges - 1]);
    gDPLoadSync(dlhead++);
    gDPLoadBlock(dlhead++, G_TX_LOADTILE, 0, 0, 32 * 32 - 1, CALC_DXT(32, G_IM_SIZ_16b_BYTES));
    gSP1Triangle(dlhead++, 0, 1, 2, 0);
    gSP1Triangle(dlhead++, 0, 2, 3, 0);
    gDisplayListHead = dlhead;
}

/**
 * Renders power meter display lists.
 * That includes the "POWER" base and the colored health segment textures.
 */
void render_dl_power_meter(s16 numHealthWedges) {
    Mtx *mtx = alloc_display_list(sizeof(Mtx));

    if (mtx == NULL) {
        return;
    }

    guTranslate(mtx, (f32) sPowerMeterHUD.x, (f32) sPowerMeterHUD.y, 0);

    gSPMatrix(gDisplayListHead++, VIRTUAL_TO_PHYSICAL(mtx++),
              G_MTX_MODELVIEW | G_MTX_MUL | G_MTX_PUSH);
    gSPDisplayList(gDisplayListHead++, &dl_power_meter_base);

    if (numHealthWedges != 0) {
        gSPDisplayList(gDisplayListHead++, &dl_power_meter_health_segments_begin);
        render_power_meter_health_segment(numHealthWedges);
        gSPDisplayList(gDisplayListHead++, &dl_power_meter_health_segments_end);
    }

    gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
}

/**
 * Power meter animation called when there's less than 8 health segments
 * Checks its timer to later change into deemphasizing mode.
 */
void animate_power_meter_emphasized(void) {
    s16 hudDisplayFlags = gHudDisplay.flags;

    if (!(hudDisplayFlags & HUD_DISPLAY_FLAG_EMPHASIZE_POWER)) {
        if (sPowerMeterVisibleTimer == 45.0) {
            sPowerMeterHUD.animation = POWER_METER_DEEMPHASIZING;
        }
    } else {
        sPowerMeterVisibleTimer = 0;
    }
}

/**
 * Power meter animation called after emphasized mode.
 * Moves power meter y pos speed until it's at 200 to be visible.
 */
static void animate_power_meter_deemphasizing(void) {
    s16 speed = 5;

    if (sPowerMeterHUD.y > 190) {
        speed = 3;
    }

    if (sPowerMeterHUD.y > 200) {
        speed = 2;
    }

    if (sPowerMeterHUD.y > 205) {
        speed = 1;
    }

    sPowerMeterHUD.y += speed;

    if (sPowerMeterHUD.y > gHudYMin) {
        sPowerMeterHUD.y = gHudYMin;
        sPowerMeterHUD.animation = POWER_METER_VISIBLE;
    }
}

/**
 * Power meter animation called when there's 8 health segments.
 * Moves power meter y pos quickly until it's at 301 to be hidden.
 */
static void animate_power_meter_hiding(void) {
    sPowerMeterHUD.y += 20;
    if (sPowerMeterHUD.y > 300) {
        sPowerMeterHUD.animation = POWER_METER_HIDDEN;
        sPowerMeterVisibleTimer = 0;
    }
}

/**
 * Handles power meter actions depending of the health segments values.
 */
void handle_power_meter_actions(s16 numHealthWedges) {
    // Show power meter if health is not full, less than 8
    if (numHealthWedges < 8 && sPowerMeterStoredHealth == 8
        && sPowerMeterHUD.animation == POWER_METER_HIDDEN) {
        sPowerMeterHUD.animation = POWER_METER_EMPHASIZED;
        sPowerMeterHUD.y = 166;
    }

    // Show power meter if health is full, has 8
    if (numHealthWedges == 8 && sPowerMeterStoredHealth == 7) {
        sPowerMeterVisibleTimer = 0;
    }

    // After health is full, hide power meter
    if (numHealthWedges == 8 && sPowerMeterVisibleTimer > 45.0) {
        sPowerMeterHUD.animation = POWER_METER_HIDING;
    }

    // Update to match health value
    sPowerMeterStoredHealth = numHealthWedges;

    // If Mario is swimming, keep power meter visible
    if (gPlayerCameraState->action & ACT_FLAG_SWIMMING) {
        if (sPowerMeterHUD.animation == POWER_METER_HIDDEN
            || sPowerMeterHUD.animation == POWER_METER_EMPHASIZED) {
            sPowerMeterHUD.animation = POWER_METER_DEEMPHASIZING;
            sPowerMeterHUD.y = 166;
        }
        sPowerMeterVisibleTimer = 0;
    }
}

/**
 * Renders the power meter that shows when Mario is in underwater
 * or has taken damage and has less than 8 health segments.
 * And calls a power meter animation function depending of the value defined.
 */
void render_hud_power_meter(void) {
    s16 shownHealthWedges = gHudDisplay.wedges;

    if (sPowerMeterHUD.animation != POWER_METER_HIDING) {
        handle_power_meter_actions(shownHealthWedges);
    }

    if (sPowerMeterHUD.animation == POWER_METER_HIDDEN) {
        return;
    }

    switch (sPowerMeterHUD.animation) {
        case POWER_METER_EMPHASIZED:
            animate_power_meter_emphasized();
            break;
        case POWER_METER_DEEMPHASIZING:
            animate_power_meter_deemphasizing();
            break;
        case POWER_METER_HIDING:
            animate_power_meter_hiding();
            break;
        default:
            break;
    }

    render_dl_power_meter(shownHealthWedges);

    sPowerMeterVisibleTimer++;
}

#ifdef VERSION_JP
#define HUD_TOP_Y 210
#else
#define HUD_TOP_Y 209
#endif

/**
 * Renders the amount of lives Mario has.
 */
void render_hud_mario_lives(void) {
    print_text(GFX_DIMENSIONS_RECT_FROM_LEFT_EDGE(22), HUD_TOP_Y, ",", 0); // 'Mario Head' glyph
    print_text(GFX_DIMENSIONS_RECT_FROM_LEFT_EDGE(38), HUD_TOP_Y, "*", 0); // 'X' glyph
    print_text_fmt_int(GFX_DIMENSIONS_RECT_FROM_LEFT_EDGE(54), HUD_TOP_Y, "%d", gHudDisplay.lives, 0);
}

void render_coin_backdrop_image(s32 x, s32 y, s32 width, s32 height, s32 s, s32 t, s32 t2) {
	s32 xl = MAX(0, x);
	s32 yl = MAX(0, y);
	s32 xh = MAX(0, x + width - 1);
	s32 yh = MAX(0, y + height - 1);
	s = (x < 0) ? s - x : s;
	t = (y < 0) ? t - y : t;
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_begin);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_RGBA16);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, segmented_to_virtual(render_coin_backdrop_image_texture_pal_rgba16));
	gDPTileSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, 0, 0, 0, 256, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadTLUTCmd(gDisplayListHead++, 7, 10);
	gDPPipeSync(gDisplayListHead++);
	gDPTileSync(gDisplayListHead++);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 1, segmented_to_virtual(render_coin_backdrop_image_texture));
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 0, 0, 7, 0, G_TX_CLAMP | G_TX_MIRROR, 5, 0, G_TX_CLAMP | G_TX_NOMIRROR, 7, 2);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadBlock(gDisplayListHead++, 7, 0, 0, 1023, 256);
	gDPPipeSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_4b, 8, 0, 0, 0, G_TX_CLAMP | G_TX_MIRROR, 5, 0, G_TX_CLAMP | G_TX_NOMIRROR, 7, 2);
	gDPSetTileSize(gDisplayListHead++, 0, 0, 0, 508, 124 + (t2 << 2));
	gSPScisTextureRectangle(gDisplayListHead++, xl << 2, yl << 2, xh << 2, yh << 2, 0, s << 5, t << 5,  4096, 1024);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_NONE);
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_end);
}

/**
 * Renders the amount of coins collected.
 */
void render_hud_coins(void) {
    s32 hudY = gHudTopY;
	s32 mag = 0;
	s32 i = gHudDisplay.coins;
	s32 k = gHudDisplay.booCoins;
	s32 booHeight = gIsConsole ? 8 : 0;
	s32 booMag = 0;
	while (i >= 10) {
		mag += 14;
		i /= 10;
	}
	if (gHudDisplay.flags & HUD_DISPLAY_FLAG_BOO) {
		while (k >= 10) {
			booMag += 14;
			k /= 10;
		}
		if (booMag > mag) {
			mag = booMag;
		}
	}

	render_coin_backdrop_image(260 - mag, (219 - hudY), 60 + mag, 32, 0, 0, 0);
    print_text(270 - mag, hudY, "+", 0); // 'Coin' glyph
    print_text(286 - mag, hudY, "*", 0); // 'X' glyph
    print_text_fmt_int(300 - mag, hudY, "%d", gHudDisplay.coins, 0);

	if (gHudDisplay.flags & HUD_DISPLAY_FLAG_MULTIPLIER) {
		if (gHudDisplay.flags & HUD_DISPLAY_FLAG_BOO) {
			render_coin_backdrop_image(265 - booMag, 27 + booHeight, 60 + booMag, 47, 0, -56 >> 2, 0); // was 47
			print_text(270 - booMag, 195 - booHeight, ",", 0); // 'Coin' glyph
			print_text(286 - booMag, 195 - booHeight, "*", 0); // 'X' glyph
			print_text_fmt_int(300 - booMag, 195 - booHeight, "%d", gHudDisplay.booCoins, 0);
		} else {
			render_coin_backdrop_image(265 + 14, 27 + booHeight, 60 - 14, 47 - 21, 0, 16 >> 2, 0); // was 5
		}
	}
}




s32 gHudTopYBoos = 219;

void render_hud_boos(void) {
	s32 boos = CL_count_bits(save_file_get_boos() & 0xFFFFF);
	s32 palette = (boos >= 20) ? 6 : 1;

	if (boos == 0) {
		gHudTopYBoos = gHudYMax;
		return;
	}

    if (gHudDisplay.flags & HUD_DISPLAY_FLAG_BOO_COUNT) {
        gHudTopYBoos = approach_s16_symmetric(gHudTopYBoos, gHudYMin, 2);
    } else {
        gHudTopYBoos = approach_s16_symmetric(gHudTopYBoos, gHudYMax, 2);
		if (gHudTopYBoos >= gHudYMax) {
			return;
		}
    }

	create_dl_translation_matrix(MENU_MTX_PUSH, 190, gHudTopYBoos + 31, 0);
	create_dl_rotation_matrix(MENU_MTX_NOPUSH, 180.0f, 0.0f, 0.0f, 1.0f);
	if (boos > 9) {
		create_dl_scale_matrix(MENU_MTX_NOPUSH, 1.25f, 1.0f, 1.0f);
		create_dl_translation_matrix(MENU_MTX_PUSH, -12, 0, 0);
	}

	gDPSetEnvColor(gDisplayListHead++, 0x04, 0x18, 0x22, 255);
	gDPSetPrimColor(gDisplayListHead++, 0, 0, 0x04, 0x18, 0x22, 255);
	gSPDisplayList(gDisplayListHead++, manager_hud_MANAGER_mesh);
	gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
	if (boos > 9) {
		gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
	}

    print_text(270 - 130, gHudTopYBoos, "}", 0); // 'Boo' glyph
    print_text(286 - 130, gHudTopYBoos, "*", palette); // 'X' glyph
    print_text_fmt_int(300 - 130, gHudTopYBoos, "%d", boos, palette);

}


















#ifdef VERSION_JP
#define HUD_STARS_X 73
#else
#define HUD_STARS_X 78
#endif

/**
 * Renders the amount of stars collected.
 * Disables "X" glyph when Mario has 100 stars or more.
 */
void render_hud_stars(void) {
    s32 hudY = gHudTopY;
    calculate_num_currency();

    print_text(GFX_DIMENSIONS_RECT_FROM_LEFT_EDGE(gHudStarsX), hudY, "-", 0); // 'Star' glyph

    print_text_fmt_int(GFX_DIMENSIONS_RECT_FROM_LEFT_EDGE(gHudStarsX + 16), hudY, "%d", gMarioState->numStars, 0);
}

/**
 * Renders the amount of keys collected.
 */

s16 sKeyRectHeight = 208;

void render_hud_keys(void) {
    s16 i;
    s16 keyCount = CL_count_bits(save_file_get_keys(0) & ~(1 << 7)) - CL_count_bits(save_file_get_keys(1) & ~(1 << 7));
	s16 heightMin = gIsConsole ? 208 - 8 : 208;
	s16 heightMax = gIsConsole ? 240 - 8 : 240;
	// s16 height;
	if (keyCount) {
		sKeyRectHeight = approach_s16_symmetric(sKeyRectHeight, heightMin, 3);
		// if (!gIsConsole || (sKeyRectHeight >= 208 && sKeyRectHeight >= 208)) {
		// height = gIsConsole ? 208 : sKeyRectHeight;
		render_coin_backdrop_image(297 - (keyCount * 6), sKeyRectHeight, 23 + (keyCount * 6), 32, 0, 32, 32); // was 32
		// }
	} else {
		sKeyRectHeight = approach_s16_symmetric(sKeyRectHeight, heightMax, 3);
	}
    for (i = 0; i < keyCount; i++) {
        print_text(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(20) - (i * 6), 213 - sKeyRectHeight, "/", 0); // unused glyph - beta key
    }
}

/**
 * Renders the timer when Mario start sliding in PSS.
 */
void render_hud_timer(void) {
    u8 *(*hudLUT)[58] = segmented_to_virtual(&main_hud_lut);
    u16 timerValFrames = gHudDisplay.timer;
    u16 timerMins = timerValFrames / (30 * 60);
    u16 timerSecs = (timerValFrames - (timerMins * 1800)) / 30;
    u16 timerFracSecs = ((timerValFrames - (timerMins * 1800) - (timerSecs * 30)) & 0xFFFF) / 3;

#ifdef VERSION_EU
    switch (eu_get_language()) {
        case LANGUAGE_ENGLISH:
            print_text(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(150), 185, "TIME", 0);
            break;
        case LANGUAGE_FRENCH:
            print_text(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(155), 185, "TEMPS", 0);
            break;
        case LANGUAGE_GERMAN:
            print_text(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(150), 185, "ZEIT", 0);
            break;
    }
#else
    print_text(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(150), 185, "TIME", 0);
#endif

    print_text_fmt_int(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(91), 185, "%0d", timerMins, 0);
    print_text_fmt_int(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(71), 185, "%02d", timerSecs, 0);
    print_text_fmt_int(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(37), 185, "%d", timerFracSecs, 0);

    gSPDisplayList(gDisplayListHead++, dl_hud_img_begin);
    render_hud_tex_lut(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(81), 32, (*hudLUT)[GLYPH_APOSTROPHE]);
    render_hud_tex_lut(GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(46), 32, (*hudLUT)[GLYPH_DOUBLE_QUOTE]);
    gSPDisplayList(gDisplayListHead++, dl_hud_img_end);
}

/**
 * Sets HUD status camera value depending of the actions
 * defined in update_camera_status.
 */
void set_hud_camera_status(s16 status) {
    sCameraHUD.status = status;
}

/**
 * Renders camera HUD glyphs using a table list, depending of
 * the camera status called, a defined glyph is rendered.
 */
void render_hud_camera_status(void) {
    u8 *(*cameraLUT)[6] = segmented_to_virtual(&main_hud_camera_lut);
    s32 x = GFX_DIMENSIONS_RECT_FROM_RIGHT_EDGE(54);
    s32 y = 205;

    if (sCameraHUD.status == CAM_STATUS_NONE) {
        return;
    }

    gSPDisplayList(gDisplayListHead++, dl_hud_img_begin);
    render_hud_tex_lut(x, y, (*cameraLUT)[GLYPH_CAM_CAMERA]);

    switch (sCameraHUD.status & CAM_STATUS_MODE_GROUP) {
        case CAM_STATUS_MARIO:
            render_hud_tex_lut(x + 16, y, (*cameraLUT)[GLYPH_CAM_MARIO_HEAD]);
            break;
        case CAM_STATUS_LAKITU:
            render_hud_tex_lut(x + 16, y, (*cameraLUT)[GLYPH_CAM_LAKITU_HEAD]);
            break;
        case CAM_STATUS_FIXED:
            render_hud_tex_lut(x + 16, y, (*cameraLUT)[GLYPH_CAM_FIXED]);
            break;
    }

    switch (sCameraHUD.status & CAM_STATUS_C_MODE_GROUP) {
        case CAM_STATUS_C_DOWN:
            render_hud_small_tex_lut(x + 4, y + 16, (*cameraLUT)[GLYPH_CAM_ARROW_DOWN]);
            break;
        case CAM_STATUS_C_UP:
            render_hud_small_tex_lut(x + 4, y - 8, (*cameraLUT)[GLYPH_CAM_ARROW_UP]);
            break;
    }

    gSPDisplayList(gDisplayListHead++, dl_hud_img_end);
}

extern int gPointLightCompatibilityMode;



void render_starpiece_backdrop_image(s32 x, s32 y, s32 width, s32 height, s32 s, s32 t) {
	s32 xl = MAX(0, x);
	s32 yl = MAX(0, y);
	s32 xh = MAX(0, x + width - 1);
	s32 yh = MAX(0, y + height - 1);
	s = (x < 0) ? s - x : s;
	t = (y < 0) ? t - y : t;
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_begin);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_RGBA16);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, segmented_to_virtual(render_starpiece_backdrop_image_texture_pal_rgba16));
	gDPTileSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, 0, 0, 0, 256, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadTLUTCmd(gDisplayListHead++, 7, 9);
	gDPPipeSync(gDisplayListHead++);
	gDPTileSync(gDisplayListHead++);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 1, segmented_to_virtual(render_starpiece_backdrop_image_texture));
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 0, 0, 7, 0, G_TX_WRAP | G_TX_MIRROR, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 5, 2);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadBlock(gDisplayListHead++, 7, 0, 0, 1023, 1024);
	gDPPipeSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_4b, 2, 0, 0, 0, G_TX_WRAP | G_TX_MIRROR, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 5, 2);
	gDPSetTileSize(gDisplayListHead++, 0, 0, 0, 124, 508);
	gSPScisTextureRectangle(gDisplayListHead++, xl << 2, yl << 2, xh << 2, yh << 2, 0, s << 5, t << 5,  4096, 1024);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_NONE);
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_end);
}


s16 sStarPieceRectX = 0;
extern s32 sLevelToChapter[COURSE_MAX];

void render_hud_starpieces(void) {
    s16 i, h;

	if (save_file_get_star_piece() == 0 || gCurrLevelNum == LEVEL_DDD) {
		sStarPieceRectX = 0;
		return;
	}

    if (gHudDisplay.flags & HUD_DISPLAY_FLAG_STAR_PIECE) {
        sStarPieceRectX = approach_s16_symmetric(sStarPieceRectX, 32, 4);
    } else {
        sStarPieceRectX = approach_s16_symmetric(sStarPieceRectX, 0, 4);
    }
    if (sCurrPlayMode == 2) {
        sStarPieceRectX = 32;
    }
    if (sStarPieceRectX != 0) {

		render_starpiece_backdrop_image(sStarPieceRectX - 32, 240 - 154 - 28, 32, 128, (32 - sStarPieceRectX) << 1, 0);
        h = save_file_get_star_piece() >> ((sLevelToChapter[gCurrCourseNum] - 1) * 5);
        for (i = 0; i < 5; i++) {
            if (h & (1 << i)) {
				print_text(sStarPieceRectX - 25, 154 - (i * 22), "#", 0);
            }
        }
    }
}


void render_brokenkey_backdrop_image(s32 x, s32 y, s32 width, s32 height, s32 s, s32 t) {
	s32 xl = MAX(0, x);
	s32 yl = MAX(0, y);
	s32 xh = MAX(0, x + width - 1);
	s32 yh = MAX(0, y + height - 1);
	s = (x < 0) ? s - x : s;
	t = (y < 0) ? t - y : t;
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_begin);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_RGBA16);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_backdrop_image_texture_pal_rgba16));
	gDPTileSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, 0, 0, 0, 256, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadTLUTCmd(gDisplayListHead++, 7, 4);
	gDPPipeSync(gDisplayListHead++);
	gDPTileSync(gDisplayListHead++);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_backdrop_image_texture));
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 0, 0, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadBlock(gDisplayListHead++, 7, 0, 0, 1023, 512);
	gDPPipeSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_4b, 4, 0, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPSetTileSize(gDisplayListHead++, 0, 0, 0, 252, 252);
	gSPScisTextureRectangle(gDisplayListHead++, xl << 2, yl << 2, xh << 2, yh << 2, 0, s << 5, t << 5,  4096, 1024);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_NONE);
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_end);
}

void render_brokenkey_1_image(s32 x, s32 y, s32 width, s32 height, s32 s, s32 t) {
	s32 xl = MAX(0, x);
	s32 yl = MAX(0, y);
	s32 xh = MAX(0, x + width - 1);
	s32 yh = MAX(0, y + height - 1);
	s = (x < 0) ? s - x : s;
	t = (y < 0) ? t - y : t;
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_begin);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_RGBA16);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_1_image_texture_pal_rgba16));
	gDPTileSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, 0, 0, 0, 256, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadTLUTCmd(gDisplayListHead++, 7, 15);
	gDPPipeSync(gDisplayListHead++);
	gDPTileSync(gDisplayListHead++);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_1_image_texture));
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 0, 0, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadBlock(gDisplayListHead++, 7, 0, 0, 1023, 512);
	gDPPipeSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_4b, 4, 0, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPSetTileSize(gDisplayListHead++, 0, 0, 0, 252, 252);
	gSPScisTextureRectangle(gDisplayListHead++, xl << 2, yl << 2, xh << 2, yh << 2, 0, s << 5, t << 5,  4096, 1024);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_NONE);
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_end);
}


void render_brokenkey_2_image(s32 x, s32 y, s32 width, s32 height, s32 s, s32 t) {
	s32 xl = MAX(0, x);
	s32 yl = MAX(0, y);
	s32 xh = MAX(0, x + width - 1);
	s32 yh = MAX(0, y + height - 1);
	s = (x < 0) ? s - x : s;
	t = (y < 0) ? t - y : t;
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_begin);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_RGBA16);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_2_image_texture_pal_rgba16));
	gDPTileSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, 0, 0, 0, 256, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadTLUTCmd(gDisplayListHead++, 7, 10);
	gDPPipeSync(gDisplayListHead++);
	gDPTileSync(gDisplayListHead++);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_2_image_texture));
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 0, 0, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadBlock(gDisplayListHead++, 7, 0, 0, 1023, 512);
	gDPPipeSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_4b, 4, 0, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPSetTileSize(gDisplayListHead++, 0, 0, 0, 252, 252);
	gSPScisTextureRectangle(gDisplayListHead++, xl << 2, yl << 2, xh << 2, yh << 2, 0, s << 5, t << 5,  4096, 1024);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_NONE);
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_end);
}


void render_brokenkey_3_image(s32 x, s32 y, s32 width, s32 height, s32 s, s32 t) {
	s32 xl = MAX(0, x);
	s32 yl = MAX(0, y);
	s32 xh = MAX(0, x + width - 1);
	s32 yh = MAX(0, y + height - 1);
	s = (x < 0) ? s - x : s;
	t = (y < 0) ? t - y : t;
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_begin);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_RGBA16);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_RGBA, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_3_image_texture_pal_rgba16));
	gDPTileSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, 0, 0, 0, 256, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 0, 0);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadTLUTCmd(gDisplayListHead++, 7, 15);
	gDPPipeSync(gDisplayListHead++);
	gDPTileSync(gDisplayListHead++);
	gDPSetTextureImage(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 1, segmented_to_virtual(render_brokenkey_3_image_texture));
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_16b, 0, 0, 7, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPLoadSync(gDisplayListHead++);
	gDPLoadBlock(gDisplayListHead++, 7, 0, 0, 1023, 512);
	gDPPipeSync(gDisplayListHead++);
	gDPSetTile(gDisplayListHead++, G_IM_FMT_CI, G_IM_SIZ_4b, 4, 0, 0, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 0, G_TX_WRAP | G_TX_NOMIRROR, 6, 2);
	gDPSetTileSize(gDisplayListHead++, 0, 0, 0, 252, 252);
	gSPScisTextureRectangle(gDisplayListHead++, xl << 2, yl << 2, xh << 2, yh << 2, 0, s << 5, t << 5,  4096, 1024);
	gDPSetTextureLUT(gDisplayListHead++, G_TT_NONE);
	gSPDisplayList(gDisplayListHead++, dl_rgba16_text_end);
}

s32 sBrokenKeyRectY = 240;

void render_hud_broken_key(void) {
	s32 flags = save_file_get_newflags(0);

	if (gHudDisplay.flags & HUD_DISPLAY_FLAG_BROKENKEY) {
		sBrokenKeyRectY = approach_s16_symmetric(sBrokenKeyRectY, 176, 6);
	} else {
		sBrokenKeyRectY = approach_s16_symmetric(sBrokenKeyRectY, 240, 5);
	}

	render_brokenkey_backdrop_image(40, sBrokenKeyRectY, 64, 64, 0, 0);

	if (flags & SAVE_NEW_FLAG_BROKEN1) {
		render_brokenkey_1_image(40, sBrokenKeyRectY, 64, 64, 0, 0);
	}
	if (flags & SAVE_NEW_FLAG_BROKEN2) {
		render_brokenkey_2_image(40, sBrokenKeyRectY, 64, 64, 0, 0);
	}
	if (flags & SAVE_NEW_FLAG_BROKEN3) {
		render_brokenkey_3_image(40, sBrokenKeyRectY, 64, 64, 0, 0);
	}
}


Vec3s sManagerPrim = {255, 255, 255};
Vec3s sManagerEnv = {255, 255, 255};
s16 sManagerYPos = 0;
s16 sManagerHue = 0;
f32 sManagerV[2] = {1.0f, 1.0f};
s16 sManagerSins = 0;

void render_hud_manager_icon(void) {
	struct Object *obj;
	f32 dist = 5000.0f;;
	if (gHudDisplay.flags & HUD_DISPLAY_FLAG_CALL) {
        gSPDisplayList(gDisplayListHead++, dl_ia_text_begin);
        gDPSetEnvColor(gDisplayListHead++, 0, 0, 0, 255);
        print_generic_string(192 + 32 - 8 + 1, 38 + sManagerYPos - 1, textAButton);
        gDPSetEnvColor(gDisplayListHead++, 255, 255, 255, 255);
        print_generic_string(192 + 32 - 8, 38 + sManagerYPos, textAButton);

        gSPDisplayList(gDisplayListHead++, dl_ia_text_end);

		sManagerSins += 0xC00;
		sManagerV[0] = 0.75f + (sins(sManagerSins) * 0.25f);
		sManagerV[1] = 0.75f + (coss(sManagerSins) * 0.25f);
		sManagerHue = (coss(sManagerSins / 2) * 15.0f);
		// CL_HSVtoRGB(sManagerHue, 1.0f, 1.0f, &sManagerEnv[0], &sManagerEnv[1], &sManagerEnv[2]);
		CL_HSVtoRGB(200 + sManagerHue, 1.0f, sManagerV[1], &sManagerEnv[0], &sManagerEnv[1], &sManagerEnv[2]);
		CL_HSVtoRGB(120 + sManagerHue, 1.0f, sManagerV[0], &sManagerPrim[0], &sManagerPrim[1], &sManagerPrim[2]);
	} else if (gHudDisplay.flags & HUD_DISPLAY_FLAG_TRACKER) {
		obj = CL_obj_find_nearest_object_with_behavior_room(gMarioObject, bhvStarPiece, gMarioCurrentRoom);
		if (obj != NULL) {
			dist = obj->oDistanceToMario;
		}
		if (dist < 1500.0f) {
			sManagerHue = approach_s16_symmetric(sManagerHue, 120, 8);
		} else if (dist < 5000.0f) {
			sManagerHue = approach_s16_symmetric(sManagerHue, 60, 8);
		} else {
			sManagerHue = approach_s16_symmetric(sManagerHue, 0, 8);
		}

		sManagerSins += 0x400;
		sManagerV[0] = 0.8f + (sins(sManagerSins) * 0.2f);
		CL_HSVtoRGB(sManagerHue, 0.9f, 0.9f, &sManagerEnv[0], &sManagerEnv[1], &sManagerEnv[2]);
		CL_HSVtoRGB(sManagerHue, 1.0f, sManagerV[0], &sManagerPrim[0], &sManagerPrim[1], &sManagerPrim[2]);
	}

	create_dl_translation_matrix(MENU_MTX_PUSH, 192, sManagerYPos, 0);

	gDPSetEnvColor(gDisplayListHead++, sManagerEnv[0], sManagerEnv[1], sManagerEnv[2], 255);
	gDPSetPrimColor(gDisplayListHead++, 0, 0, sManagerPrim[0], sManagerPrim[1], sManagerPrim[2], 255);
	gSPDisplayList(gDisplayListHead++, manager_hud_MANAGER_mesh);
	gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
}



s32 sBossHealthX = -32;
f32 sBossHealthLastFrame = 255.0f;
s8 sBossTwitchBit = 0;

#include "boss_health_huds/boss_health_hud/model.inc.c"
#include "boss_health_huds/boss_health_bar/model.inc.c"

void render_boss_health(void) {
	struct Object *obj = CL_objptr_nearest_object_behavior(gMarioObject, bhvTheController);
	f32 health = 0.0f;

	if (obj != NULL && obj->oOpacity != 0 && obj->oAction != 0) {
		health = obj->oFloatFC / 255.0f;
	} else {
		return;
	}

	if (sBossHealthLastFrame != obj->oFloatFC) {
		if (sBossTwitchBit) {
			sBossHealthX--;
		} else {
			sBossHealthX++;
		}
		sBossTwitchBit ^= 1;
		sBossHealthLastFrame = obj->oFloatFC;
	} else {
		sBossHealthX = approach_s16_symmetric(sBossHealthX, 0, 2);
	}



	create_dl_translation_matrix(MENU_MTX_PUSH, sBossHealthX, 79, 5);

	// gDPSetEnvColor(gDisplayListHead++, sManagerEnv[0], sManagerEnv[1], sManagerEnv[2], 255);
	// gDPSetPrimColor(gDisplayListHead++, 0, 0, sManagerPrim[0], sManagerPrim[1], sManagerPrim[2], 255);
	gSPDisplayList(gDisplayListHead++, boss_health_hud_BossHealthHud_mesh);
	create_dl_translation_matrix(MENU_MTX_NOPUSH, 0, 5, 0);
	create_dl_scale_matrix(MENU_MTX_NOPUSH, 1.0f, health, 1.0f);
	gSPDisplayList(gDisplayListHead++, boss_health_bar_BossHealthBar_mesh);
	gSPPopMatrix(gDisplayListHead++, G_MTX_MODELVIEW);
}






s32 gPauseHudFirstFrame = 0;


/**
 * Render HUD strings using hudDisplayFlags with it's render functions,
 * excluding the cannon reticle which detects a camera preset for it.
 */
void render_hud(void) {
	s32 canonCheck = (gMarioState->action == ACT_IN_CANNON);
    s16 hudDisplayFlags = gHudDisplay.flags;

	if (gCurrDemoInput != NULL) {
		render_logo();
		if (gMarioObject != NULL) {
			gMarioObject->header.gfx.sharedChild = gLoadedGraphNodes[0];
			set_mario_npc_dialog(1);
		}
		if (gCamera != NULL) {
			gCamera->comitCutscene = 19;
		}
		return;
	}

    if (hudDisplayFlags == HUD_DISPLAY_NONE) {
        sPowerMeterHUD.animation = POWER_METER_HIDDEN;
        sPowerMeterStoredHealth = 8;
        sPowerMeterVisibleTimer = 0;
    } else {
		if (gIsConsole) {
			gHudYMax = 235 - 8;
			gHudYMin = 219 - 8;
		}
        create_dl_ortho_matrix();

		// check if mario has starpiece tracker
		if (save_file_get_newflags(1) & SAVE_TOAD_FLAG_TRACKER_1 && !(save_file_get_options() & SAVE_OPTION_TRACKER)) {
			if (CL_obj_find_nearest_object_with_behavior_room(gCurrentObject, bhvStarPiece, gMarioCurrentRoom)) {
				if (gCurrLevelNum != LEVEL_SSL || (save_file_get_newflags(1) & SAVE_TOAD_FLAG_MIND_ENTRY))
				gHudDisplay.flags |= HUD_DISPLAY_FLAG_TRACKER;
			} else {
				gHudDisplay.flags &= ~HUD_DISPLAY_FLAG_TRACKER;
			}
		} else {
			gHudDisplay.flags &= ~HUD_DISPLAY_FLAG_TRACKER;
		}

		if (gCurrLevelNum == LEVEL_DDD) {
			render_boss_health();
		}

		if (gHudDisplay.flags & (HUD_DISPLAY_FLAG_TRACKER | HUD_DISPLAY_FLAG_CALL)) {
			sManagerYPos = approach_s16_symmetric(sManagerYPos, 0, 4);
		} else {
			sManagerYPos = approach_s16_symmetric(sManagerYPos, -48, 4);
		}
		if (sManagerYPos > -48) {
			render_hud_manager_icon();
		} else {
			vec3s_set(sManagerPrim, 0, 0, 0);
			vec3s_set(sManagerEnv, 0, 0, 0);
			sManagerSins = 0;
		}

        if (gCurrentArea != NULL && gCurrentArea->camera->mode == CAMERA_MODE_INSIDE_CANNON) {
            render_hud_cannon_reticle();
        }
        if (sCurrPlayMode == 2) {
            gHudTopY = gHudYMin;
			gHudTopYBoos = gHudYMin;
			if (should_display_brokenkey()) {
				sBrokenKeyRectY = 176;
			}
        }
		if (gHudDisplay.flags & HUD_DISPLAY_FLAG_MULTIPLIER) {
			gHudDisplay.flags |= HUD_DISPLAY_FLAG_LOWER;
		}
		
        if (gHudTopY < gHudYMax && gCamera->cutscene != CUTSCENE_OPENING && sCurrPlayMode != 2) {
            render_hud_coins();
        }

		if (sCurrPlayMode != 2) {
			render_hud_boos();
		}

		if (sCurrPlayMode != 2) {
        	render_hud_keys();
		}

        if (!canonCheck && sCurrPlayMode != 2 && gHudTopY < gHudYMax && (gCurrLevelNum == LEVEL_CCM || gCurrLevelNum == LEVEL_BBH)) {
            render_hud_stars();
        }

        if (hudDisplayFlags & HUD_DISPLAY_FLAG_CAMERA_AND_POWER && (gCamera->comitCutscene < 29 || gCamera->comitCutscene > 31)) {
            render_hud_power_meter();
            //render_hud_camera_status();
        }

        if (hudDisplayFlags & HUD_DISPLAY_FLAG_TIMER) {
            render_hud_timer();
        }


        if (gCurrLevelNum == LEVEL_HMC && sCurrPlayMode == 0) {
            render_targets();
        }
		if (hudDisplayFlags & HUD_DISPLAY_FLAG_BROKENKEY || (sBrokenKeyRectY < 240 && sCurrPlayMode != 2)/* || sCurrPlayMode == 2*/) {
			render_hud_broken_key();
		}

		if (sCurrPlayMode != 2) {
			render_hud_starpieces();
		}

		if (sCurrPlayMode == 2 && gPauseHudFirstFrame < 2) {
			render_hud_starpieces();
			render_hud_coins();
			render_hud_boos();
			render_hud_keys();
			if (gCurrLevelNum == LEVEL_DDD) {
				render_boss_health();
			}
			if (gCurrLevelNum == LEVEL_CCM || gCurrLevelNum == LEVEL_BBH) {
				render_hud_stars();
			}

			render_hud_broken_key();
			gPauseHudFirstFrame++;
		}


        // if (gSurfacePoolError & NOT_ENOUGH_ROOM_FOR_SURFACES)
        // {
        //     print_text(10, 40, "SURFACE POOL FULL", 0);
        // }
        // if (gSurfacePoolError & NOT_ENOUGH_ROOM_FOR_NODES)
        // {
        //     print_text(10, 60, "SURFACE NODE POOL FULL", 0);
        // }
        //print_text_fmt_int(10, 10, "%d", gPointLightCompatibilityMode, 0);
    }
}

// ...
/*void print_s2d_string(s16 x, s16 y, char *str) {
	s2d_init();
	uObjMtx *buffer;
	buffer = alloc_display_list(0x200 * sizeof(uObjMtx));
	s2d_print(x, y, str, buffer);
	s2d_stop();
}*/

//#include "src/s2d_engine/sprites/room_names.c"

//extern s8 sLevelRoomOffsets[];
//s32 gRoomEntryTimer = -1;

void render_s2d_room_names(void) {
    /*s16 y;
    if (gMarioCurrentRoom != gMarioPreviousRoom2) {
        gRoomEntryTimer = 0;

    }
    gMarioPreviousRoom2 = gMarioCurrentRoom;

    if (gRoomEntryTimer >= 0) {
        gRoomEntryTimer++;
        y = 290;
        if (gRoomEntryTimer < 20) {
            y = 290 - (gRoomEntryTimer * 4);
        } else if (gRoomEntryTimer < 70) {
            y = 210;
        } else {
            y = 210 + ((gRoomEntryTimer - 70) * 4);
        }

        print_s2d_string(40, y, roomNames[(gMarioCurrentRoom - 1) + sLevelRoomOffsets[gCurrCourseNum - 1]]);
        if (gRoomEntryTimer > 90) {
            gRoomEntryTimer = -1;
        }
    }
    //print_text_fmt_int(20, 20, "%d", (gMarioCurrentRoom - 1) + sLevelRoomOffsets[gCurrCourseNum - 1], 0);*/
}


// #include "src/s2d_engine/sprites/starpiece/starpiece.c"
// #include "src/s2d_engine/sprites/starpiece_chart/starpiece_chart.c"

// uObjMtx starpiecebuf[0x8];

/*void s2d_print_starpiece(s16 x, s16 y, s16 idx) {
	s2d_init();
    call_starpiece_sprite_dl(idx, x, y, &starpiecebuf[idx], idx);
	s2d_stop();
}*/

/*void render_s2d_hud(void) {
    s16 i, h;
    //print_text_fmt_int(20, 20, "%d", main_pool_available(), 0);
    if (gHudDisplay.flags & HUD_DISPLAY_FLAG_STAR_PIECE) {
        starpiece_chart_bg.b.frameX = approach_s16_symmetric(starpiece_chart_bg.b.frameX, 0<<2, 4<<2);
    } else {
        starpiece_chart_bg.b.frameX = approach_s16_symmetric(starpiece_chart_bg.b.frameX, -120, 4<<2);
    }
    if (sCurrPlayMode == 2) {
        starpiece_chart_bg.b.frameX = 0;
    }
    if (starpiece_chart_bg.b.frameX != -120) {
        s2d_init();
        gSPDisplayList(gDisplayListHead++, starpiece_chart_bg_dl);
        s2d_stop();
        //h = save_file_get_star_piece();
        //render_s2d_star_pieces();
        s2d_print_starpiece(-20, -20, 0);
        h = save_file_get_star_piece();
        for (i = 0; i < 5; i++) {
            if (h & (1 << i)) {
                s2d_print_starpiece((starpiece_chart_bg.b.frameX / 5) + 4, 70 + (i * 21), i+1);
            }
        }
    }
    //render_s2d_room_names();
}*/